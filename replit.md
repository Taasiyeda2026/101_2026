# טופס 101 - כרטיס עובד ובקשה להקלה במס

## סקירה כללית
מערכת מקוונת למילוי טופס 101 של רשות המסים - כרטיס עובד ובקשה להקלה ולתיאום מס.
הטופס כולל ממשק משתמש מודרני עם אשף 5 שלבים, וביכולתו להפיק PDF ממולא עם חתימה דיגיטלית.

## מבנה הפרויקט
- `index.html` - טופס 101 הראשי עם ממשק המשתמש
- `bank-details.html` - טופס פרטי בנק ומסמכים לעובד חדש
- `server.py` - שרת Python פשוט להגשת קבצים סטטיים
- `101_2026.html` - קובץ הטופס המקורי (לגיבוי)
- `attached_assets/` - קבצים מצורפים (PDF מקורי של רשות המסים)

## שלבי הטופס
1. **פרטי מעסיק ועובד** - שם, כתובת, ת.ז., פרטי קשר
2. **ילדים והכנסות** - פרטי ילדים עד גיל 19, סוג ההכנסה ממעסיק
3. **הכנסות אחרות ובן/בת זוג** - הכנסות נוספות, פרטי בן/בת הזוג
4. **זיכויים ותיאום מס** - בקשות לפטור וזיכוי ממס
5. **הצהרה וחתימה** - הצהרה רשמית וחתימה דיגיטלית

## תכונות
- ממשק עברי מלא (RTL)
- חתימה דיגיטלית על קנבס (עכבר/מגע)
- חותמת זמן אוטומטית
- הפקת PDF עם כל הנתונים
- עיצוב מודרני ונגיש
- תמיכה במובייל
- אישור לפני סימון זיכויים (חלק ח')

## טופס פרטי בנק (עובד חדש)
הטופס כולל:
- פרטי חשבון בנק (בנק, סניף, מספר חשבון)
- העלאת אישור ניהול חשבון
- העלאת צילום תעודת זהות (קדמי, אחורי, ביומטרי)
- הצהרה והפקת PDF

## חתימה דיגיטלית
החתימה הדיגיטלית במערכת זו כוללת:
- חתימה גרפית על קנבס
- חותמת זמן (timestamp) אוטומטית
- תיעוד תאריך החתימה

**הערה:** לחתימה דיגיטלית מאושרת לפי חוק חתימה אלקטרונית נדרשת תשתית PKI חיצונית.

## הפעלה
הפרויקט רץ על פורט 5000:
```
python server.py
```

## טכנולוגיית PDF
- **ספרייה:** pdf-lib + fontkit
- **שיטה:** טעינת הטופס הרשמי של רשות המסים כרקע והדפסת הנתונים במיקומים המדויקים
- **קובץ רקע:** `attached_assets/tofes-101_1769026021658.pdf`

## כלי כיול (`/calibration.html`)
כלי לכיול מדויק של מיקומי השדות בטופס PDF.

### עקרונות טכניים:
1. **נעילה לגודל A4 אמיתי** - בדיקה שה-PDF בגודל 595×842 נקודות. קבצים בגודל אחר לא נטענים.
2. **צירי PDF אמיתיים** - Canvas מצייר מלמעלה למטה, PDF עובד מלמטה למעלה. המרה: `Y = גובה_עמוד - מיקום_עכבר`
3. **קנה מידה קבוע (scale=1)** - ללא זום אוטומטי, כל נקודה בקואורדינטות קבועות ויציבות

### שימוש:
1. העלה PDF רשמי של רשות המסים
2. בחר עמוד (1 או 2)
3. הקלד שם שדה בתיבה ולחץ על המיקום בטופס
4. ייצא JSON עם כל הקואורדינטות
5. עדכן את אובייקטי P1/P2 ב-index.html

### שדות מוגדרים:
- **עמוד 1:** ~50 שדות (מעסיק, עובד, מצב משפחתי, הכנסות, בן/בת זוג)
- **עמוד 2:** ~24 שדות (זיכויים, תיאום מס, חתימה)

## פריסה
מוגדר לפריסה סטטית - מגיש קבצי HTML, CSS ו-JavaScript ישירות.

## עדכון אחרון
ינואר 2026 - עדכון הפקת PDF עם קואורדינטות מכוילות
